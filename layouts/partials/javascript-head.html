<!-- JS files that are loading in the <head> -->
{{ $isLocalServer := .Site.IsServer }}
{{ $options := "" }}
{{ $langRedirects := "" }}
{{ $regionRedirects := "" }}
{{ $defines := dict "CI_COMMIT_SHORT_SHA" (getenv "CI_COMMIT_SHORT_SHA" | default `""`) "process.env.NODE_ENV" `"development"` "process.env.RESET_APP_DATA_TIMER" `10` }}

{{ if $isLocalServer }}
  {{ $options = dict "defines" $defines "sourceMap" "inline" }}
  {{ $langRedirects = resources.Get "scripts/lang-redirects.js" | js.Build $options }}
  {{ $regionRedirects = resources.Get "scripts/region-redirects.js" | js.Build $options }}
{{ else }}
  {{ $options = dict "defines" $defines "sourceMap" "inline" "minify" true }}
  {{ $langRedirects = resources.Get "scripts/lang-redirects.js" | js.Build $options | resources.Fingerprint "sha512" }}
  {{ $regionRedirects = resources.Get "scripts/region-redirects.js" | js.Build $options | resources.Fingerprint "sha512" }}
{{ end }}

{{- $dd_rum := resources.Get "node_modules/datadog-rum.js" -}}
{{- $dd_logs := resources.Get "node_modules/datadog-logs.js" -}}
{{- $dd_libs_js := slice $dd_rum $dd_logs | resources.Concat "js/dd-libs.js" -}}
{{- $dd_browser_logs_rum := resources.Get "scripts/components/dd-browser-logs-rum.js" | js.Build $options -}}

<script>{{ $dd_libs_js.Content | safeJS }}</script>
<script type="text/javascript" src="{{ $dd_browser_logs_rum.RelPermalink }}"></script>

{{ if $isLocalServer }}
  <script type="text/javascript" src="{{ $langRedirects.RelPermalink }}"></script>
  <script type="text/javascript" src="{{ $regionRedirects.RelPermalink }}"></script>
{{ else }}
  <script type="text/javascript" src="{{ $langRedirects.RelPermalink }}" integrity="{{ $langRedirects.Data.Integrity }}"></script>
  <script type="text/javascript" src="{{ $regionRedirects.RelPermalink }}" integrity="{{ $regionRedirects.Data.Integrity }}"></script>
{{ end }}
  